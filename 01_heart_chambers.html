<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Chambers - Drag & Drop Study Game</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #0c1426 50%, #1e3a5f 100%);
            color: #e4e4e4;
            padding: 20px;
            min-height: 100vh;
        }
        .container { max-width: 1600px; margin: 0 auto; }
        h1 {
            text-align: center;
            color: #60a5fa;
            margin-bottom: 10px;
            font-size: 2.2em;
            text-shadow: 0 0 20px rgba(96, 165, 250, 0.5);
        }
        .subtitle { text-align: center; color: #a0a0a0; margin-bottom: 25px; font-size: 1.1em; }
        .stats-controls {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 25px; flex-wrap: wrap; gap: 15px;
        }
        .stats { display: flex; gap: 25px; flex-wrap: wrap; }
        .stat-item {
            background: rgba(96, 165, 250, 0.1);
            padding: 12px 20px; border-radius: 8px;
            border: 1px solid rgba(96, 165, 250, 0.3);
        }
        .stat-label { color: #60a5fa; font-weight: bold; margin-right: 8px; }
        .controls { display: flex; gap: 12px; flex-wrap: wrap; }
        .btn {
            padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer;
            font-size: 0.95em; font-weight: 600; transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .btn-primary { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(59,130,246,0.4); }
        .btn-secondary { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; }
        .btn-secondary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(245,158,11,0.4); }
        .btn-success { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; }
        .btn-success:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(16,185,129,0.4); }
        .btn-danger { background: linear-gradient(135deg, #ef4444 0%, #b91c1c 100%); color: white; }
        .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(239,68,68,0.4); }
        .main-content { display: grid; grid-template-columns: 350px 1fr; gap: 25px; align-items: start; }
        .word-bank-container {
            position: sticky; top: 20px;
            background: rgba(15, 23, 42, 0.95);
            border-radius: 12px; padding: 20px;
            border: 2px solid rgba(96, 165, 250, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }
        .word-bank-title { color: #60a5fa; font-size: 1.3em; margin-bottom: 15px; text-align: center; font-weight: bold; }
        .tabs { display: flex; gap: 5px; margin-bottom: 15px; border-bottom: 2px solid rgba(96, 165, 250, 0.3); }
        .tab {
            flex: 1; padding: 10px; background: rgba(255,255,255,0.05); border: none;
            color: #a0a0a0; cursor: pointer; transition: all 0.3s ease;
            font-size: 0.9em; font-weight: 600; border-radius: 8px 8px 0 0;
        }
        .tab.active { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color: white; }
        .tab:hover:not(.active) { background: rgba(255,255,255,0.1); color: #e4e4e4; }
        .word-bank {
            min-height: 400px; max-height: 70vh; overflow-y: auto;
            padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px; display: none;
        }
        .word-bank.active { display: block; }
        .word-bank::-webkit-scrollbar { width: 8px; }
        .word-bank::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); border-radius: 4px; }
        .word-bank::-webkit-scrollbar-thumb { background: rgba(96,165,250,0.5); border-radius: 4px; }
        .draggable-item {
            background: linear-gradient(135deg, #1e3a5f 0%, #172d4d 100%);
            padding: 12px 15px; margin-bottom: 10px; border-radius: 8px; cursor: move;
            border: 2px solid rgba(96, 165, 250, 0.4); transition: all 0.3s ease;
            font-size: 0.95em; line-height: 1.4;
        }
        .draggable-item:hover {
            background: linear-gradient(135deg, #2a4d7a 0%, #1e3a5f 100%);
            border-color: #60a5fa; transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(96, 165, 250, 0.3);
        }
        .draggable-item.dragging { opacity: 0.5; transform: rotate(2deg); }
        .cards-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(480px, 1fr)); gap: 20px; }
        .drug-card {
            background: rgba(30, 58, 95, 0.95); border-radius: 12px; padding: 20px;
            border: 2px solid rgba(96, 165, 250, 0.3); box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }
        .drug-card-title {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white; padding: 12px; border-radius: 8px;
            font-size: 1.2em; font-weight: bold; margin-bottom: 15px; text-align: center;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        .drop-zones { display: grid; gap: 12px; }
        .drop-row { display: grid; grid-template-columns: 140px 1fr; gap: 10px; align-items: start; }
        .drop-label {
            background: rgba(96, 165, 250, 0.1); padding: 10px; border-radius: 6px;
            font-weight: 600; color: #60a5fa; font-size: 0.9em;
            display: flex; align-items: center; border: 1px solid rgba(96, 165, 250, 0.3);
        }
        .drop-zone {
            min-height: 60px; background: rgba(0,0,0,0.3);
            border: 2px dashed rgba(96, 165, 250, 0.3); border-radius: 8px;
            padding: 10px; transition: all 0.3s ease;
            display: flex; flex-direction: column; gap: 8px;
        }
        .drop-zone.drag-over {
            background: rgba(96, 165, 250, 0.2); border-color: #60a5fa; border-style: solid;
            box-shadow: 0 0 20px rgba(96, 165, 250, 0.3);
        }
        .dropped-item {
            background: linear-gradient(135deg, #1e3a5f 0%, #172d4d 100%);
            padding: 10px 12px; border-radius: 6px; cursor: move;
            border: 2px solid rgba(96, 165, 250, 0.4); transition: all 0.3s ease;
            font-size: 0.9em; line-height: 1.4;
        }
        .dropped-item:hover { background: linear-gradient(135deg, #2a4d7a 0%, #1e3a5f 100%); border-color: #60a5fa; }
        .dropped-item.correct { background: linear-gradient(135deg, #0f9b0f 0%, #0a7c0a 100%); border-color: #00ff00; animation: correctPulse 0.5s ease; }
        .dropped-item.incorrect { background: linear-gradient(135deg, #c41e3a 0%, #9a1829 100%); border-color: #ff4444; animation: incorrectShake 0.5s ease; }
        @keyframes correctPulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05);box-shadow:0 0 20px rgba(0,255,0,0.5)} }
        @keyframes incorrectShake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
        .summary-modal {
            display: none; position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.8); z-index: 1000;
            justify-content: center; align-items: center; padding: 20px;
        }
        .summary-modal.active { display: flex; }
        .summary-content {
            background: linear-gradient(135deg, #0f172a 0%, #0c1426 100%);
            border-radius: 12px; padding: 30px; max-width: 900px; max-height: 90vh;
            overflow-y: auto; border: 2px solid rgba(96, 165, 250, 0.5);
            box-shadow: 0 10px 50px rgba(0,0,0,0.8);
        }
        .summary-content::-webkit-scrollbar { width: 10px; }
        .summary-content::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); border-radius: 5px; }
        .summary-content::-webkit-scrollbar-thumb { background: rgba(96,165,250,0.5); border-radius: 5px; }
        .summary-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 25px; padding-bottom: 15px;
            border-bottom: 2px solid rgba(96, 165, 250, 0.3);
        }
        .summary-title { color: #60a5fa; font-size: 1.8em; font-weight: bold; }
        .close-btn {
            background: rgba(255,68,68,0.2); border: 2px solid #ff4444; color: #ff4444;
            padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;
        }
        .close-btn:hover { background: #ff4444; color: white; }
        .summary-drug { margin-bottom: 25px; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; border-left: 4px solid #60a5fa; }
        .summary-drug-title { color: #60a5fa; font-size: 1.3em; margin-bottom: 15px; font-weight: bold; }
        .summary-category { margin-bottom: 12px; }
        .summary-category-title { color: #f59e0b; font-weight: 600; margin-bottom: 5px; font-size: 1.05em; }
        .summary-category-content { color: #e4e4e4; padding-left: 15px; line-height: 1.6; }
        @media (max-width: 1200px) {
            .main-content { grid-template-columns: 1fr; }
            .word-bank-container { position: relative; top: 0; }
            .cards-container { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6em; }
            .stats-controls { flex-direction: column; }
            .stats, .controls { width: 100%; justify-content: center; }
            .btn { flex: 1; min-width: 120px; }
            .drop-row { grid-template-columns: 1fr; }
            .drop-label { text-align: center; }
        }
    </style>
</head>
<body>
<a href="index.html" style="position:fixed;top:12px;left:12px;z-index:9999;background:rgba(0,0,0,0.55);color:#94a3b8;border:1px solid rgba(255,255,255,0.13);border-radius:20px;padding:5px 13px;font-size:.72rem;text-decoration:none;font-family:'Segoe UI',sans-serif;backdrop-filter:blur(8px);transition:.15s;letter-spacing:.3px;" onmouseover="this.style.color='#f1f5f9';this.style.borderColor='rgba(255,255,255,0.3)'" onmouseout="this.style.color='#94a3b8';this.style.borderColor='rgba(255,255,255,0.13)'">&#8592; Index</a>
    <div class="container">
        <h1>ðŸ«€ Heart Chambers Anatomy</h1>
        <p class="subtitle">Drag and drop facts to match each heart chamber</p>
        <div class="stats-controls">
            <div class="stats">
                <div class="stat-item"><span class="stat-label">Score:</span><span id="score">0</span>/<span id="total">0</span></div>
                <div class="stat-item"><span class="stat-label">Remaining:</span><span id="remaining">0</span></div>
            </div>
            <div class="controls">
                <button class="btn btn-primary" onclick="showSummary()">ðŸ“‹ Show Summary</button>
                <button class="btn btn-secondary" onclick="showHint()">ðŸ’¡ Hint</button>
                <button class="btn btn-success" onclick="showAllAnswers()">âœ“ Show All Answers</button>
                <button class="btn btn-danger" onclick="resetGame()">ðŸ”„ Reset</button>
            </div>
        </div>
        <div class="main-content">
            <div class="word-bank-container">
                <div class="word-bank-title">ðŸ“š Word Bank</div>
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('location', this)">Location</button>
                    <button class="tab" onclick="switchTab('blood', this)">Blood</button>
                    <button class="tab" onclick="switchTab('vessels', this)">Vessels</button>
                    <button class="tab" onclick="switchTab('clinical', this)">Clinical</button>
                </div>
                <div id="location-bank" class="word-bank active"></div>
                <div id="blood-bank" class="word-bank"></div>
                <div id="vessels-bank" class="word-bank"></div>
                <div id="clinical-bank" class="word-bank"></div>
            </div>
            <div class="cards-container" id="cards-container"></div>
        </div>
    </div>
    <div class="summary-modal" id="summaryModal">
        <div class="summary-content">
            <div class="summary-header">
                <div class="summary-title">ðŸ“– Complete Summary</div>
                <button class="close-btn" onclick="closeSummary()">Close</button>
            </div>
            <div id="summaryContent"></div>
        </div>
    </div>
    <script>
        const categoryKeys = ['location', 'blood', 'vessels', 'clinical'];
        const categoryLabels = {
            location: 'Location / Border',
            blood: 'Blood Handled',
            vessels: 'Key Vessels',
            clinical: 'Clinical Pearl'
        };

        const gameData = {
            "Right Atrium (RA)": {
                location: "Rightmost boundary of heart; forms the right border on CXR",
                blood: "Receives deoxygenated blood from the entire body",
                vessels: "SVC + IVC deliver blood in; tricuspid valve leads out to RV",
                clinical: "Contains coronary sinus, crista terminalis, pectinate muscles, and fossa ovalis"
            },
            "Right Ventricle (RV)": {
                location: "Anterior surface of heart; faces the sternum and ribs",
                blood: "Pumps deoxygenated blood to the lungs",
                vessels: "Receives from RA via tricuspid valve; ejects via pulmonary valve â†’ pulmonary artery",
                clinical: "Most commonly injured chamber in penetrating chest trauma (stab/gunshot wounds)"
            },
            "Left Atrium (LA)": {
                location: "Base of heart; most posterior chamber â€” closest to the esophagus",
                blood: "Receives oxygenated blood returning from the lungs",
                vessels: "Four pulmonary veins deliver blood in; mitral valve leads out to LV",
                clinical: "Enlargement compresses esophagus (Ortner's syndrome); auricle is A-fib thrombus site"
            },
            "Left Ventricle (LV)": {
                location: "Apex of heart; most inferior/leftward point; forms the left border on CXR",
                blood: "Pumps oxygenated blood to the entire body via the aorta",
                vessels: "Receives from LA via mitral valve; ejects via aortic valve â†’ aorta",
                clinical: "Two-thirds of diaphragmatic surface; thickest walls due to high systemic resistance"
            }
        };

        let score = 0, totalItems = 0, draggedElement = null, allItems = {};

        function initGame() {
            const cardsContainer = document.getElementById('cards-container');
            cardsContainer.innerHTML = '';
            allItems = {};
            categoryKeys.forEach(cat => { allItems[cat] = []; });
            Object.keys(gameData).forEach(entity => {
                categoryKeys.forEach(cat => {
                    allItems[cat].push({ text: gameData[entity][cat], entity, category: cat });
                });
            });
            categoryKeys.forEach(cat => { allItems[cat] = shuffleArray(allItems[cat]); });
            totalItems = Object.keys(gameData).length * categoryKeys.length;
            Object.keys(gameData).forEach(entity => {
                const card = document.createElement('div');
                card.className = 'drug-card';
                const zonesHtml = categoryKeys.map(cat => `
                    <div class="drop-row">
                        <div class="drop-label">${categoryLabels[cat]}</div>
                        <div class="drop-zone" data-entity="${entity}" data-category="${cat}"></div>
                    </div>`).join('');
                card.innerHTML = `<div class="drug-card-title">${entity}</div><div class="drop-zones">${zonesHtml}</div>`;
                cardsContainer.appendChild(card);
            });
            populateWordBanks();
            setupDragAndDrop();
            updateStats();
        }

        function shuffleArray(array) {
            const a = [...array];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        function populateWordBanks() {
            categoryKeys.forEach(cat => {
                const bank = document.getElementById(`${cat}-bank`);
                bank.innerHTML = '';
                allItems[cat].forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'draggable-item';
                    div.draggable = true;
                    div.textContent = item.text;
                    div.dataset.entity = item.entity;
                    div.dataset.category = item.category;
                    div.dataset.id = `${cat}-${index}`;
                    bank.appendChild(div);
                });
            });
        }

        function setupDragAndDrop() {
            document.querySelectorAll('.draggable-item, .dropped-item').forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
            });
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragleave', handleDragLeave);
            });
            document.querySelectorAll('.word-bank').forEach(bank => {
                bank.addEventListener('dragover', handleDragOver);
                bank.addEventListener('drop', handleDropToBank);
                bank.addEventListener('dragleave', handleDragLeave);
            });
        }

        function handleDragStart(e) { draggedElement = e.target; e.target.classList.add('dragging'); e.dataTransfer.effectAllowed = 'move'; }
        function handleDragEnd(e) { e.target.classList.remove('dragging'); }

        function handleDragOver(e) {
            e.preventDefault(); e.dataTransfer.dropEffect = 'move';
            const t = e.target;
            if (t.classList.contains('drop-zone') || t.classList.contains('word-bank')) t.classList.add('drag-over');
        }
        function handleDragLeave(e) {
            const t = e.target;
            if (t.classList.contains('drop-zone') || t.classList.contains('word-bank')) t.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target.closest('.drop-zone');
            if (!dropZone) return;
            dropZone.classList.remove('drag-over');
            if (dropZone.children.length > 0) return;
            const entityName = dropZone.dataset.entity;
            const category = dropZone.dataset.category;
            const draggedEntity = draggedElement.dataset.entity;
            const draggedCategory = draggedElement.dataset.category;
            if (draggedElement.parentElement.classList.contains('word-bank') ||
                draggedElement.parentElement.classList.contains('drop-zone')) {
                draggedElement.remove();
            }
            const droppedItem = document.createElement('div');
            droppedItem.className = 'dropped-item';
            droppedItem.draggable = true;
            droppedItem.textContent = draggedElement.textContent;
            droppedItem.dataset.entity = draggedEntity;
            droppedItem.dataset.category = draggedCategory;
            droppedItem.dataset.id = draggedElement.dataset.id;
            if (entityName === draggedEntity && category === draggedCategory) {
                droppedItem.classList.add('correct'); score++;
            } else {
                droppedItem.classList.add('incorrect');
            }
            dropZone.appendChild(droppedItem);
            setupDragAndDrop();
            updateStats();
        }

        function handleDropToBank(e) {
            e.preventDefault();
            const wordBank = e.target.closest('.word-bank');
            if (!wordBank) return;
            wordBank.classList.remove('drag-over');
            if (!draggedElement.classList.contains('dropped-item')) return;
            const category = draggedElement.dataset.category;
            const targetBank = document.getElementById(`${category}-bank`);
            if (draggedElement.classList.contains('correct')) score--;
            draggedElement.remove();
            const newItem = document.createElement('div');
            newItem.className = 'draggable-item';
            newItem.draggable = true;
            newItem.textContent = draggedElement.textContent;
            newItem.dataset.entity = draggedElement.dataset.entity;
            newItem.dataset.category = draggedElement.dataset.category;
            newItem.dataset.id = draggedElement.dataset.id;
            targetBank.insertBefore(newItem, targetBank.firstChild);
            setupDragAndDrop();
            updateStats();
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('total').textContent = totalItems;
            let remaining = 0;
            document.querySelectorAll('.word-bank').forEach(b => { remaining += b.querySelectorAll('.draggable-item').length; });
            document.getElementById('remaining').textContent = remaining;
            if (score === totalItems && totalItems > 0) setTimeout(() => alert('ðŸŽ‰ Perfect score! You know your heart anatomy!'), 500);
        }

        function switchTab(tab, btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.word-bank').forEach(b => b.classList.remove('active'));
            if (btn) btn.classList.add('active');
            document.getElementById(`${tab}-bank`).classList.add('active');
        }

        function showHint() {
            const emptyZones = Array.from(document.querySelectorAll('.drop-zone')).filter(z => z.children.length === 0);
            if (emptyZones.length === 0) { alert('All zones are filled!'); return; }
            const zone = emptyZones[Math.floor(Math.random() * emptyZones.length)];
            const cat = zone.dataset.category;
            const entity = zone.dataset.entity;
            const tabBtn = Array.from(document.querySelectorAll('.tab')).find(t => t.getAttribute('onclick').includes(`'${cat}'`));
            if (tabBtn) switchTab(cat, tabBtn);
            setTimeout(() => {
                const correctItem = Array.from(document.querySelectorAll('.draggable-item')).find(i =>
                    i.dataset.entity === entity && i.dataset.category === cat);
                if (correctItem) {
                    correctItem.style.animation = 'correctPulse 1s ease 3';
                    correctItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    setTimeout(() => { correctItem.style.animation = ''; }, 3000);
                }
            }, 100);
        }

        function showAllAnswers() {
            if (!confirm('This will reveal all correct answers. Continue?')) return;
            document.querySelectorAll('.drop-zone').forEach(zone => { zone.innerHTML = ''; });
            document.querySelectorAll('.drop-zone').forEach(zone => {
                const entity = zone.dataset.entity;
                const cat = zone.dataset.category;
                const droppedItem = document.createElement('div');
                droppedItem.className = 'dropped-item correct';
                droppedItem.textContent = gameData[entity][cat];
                zone.appendChild(droppedItem);
            });
            document.querySelectorAll('.word-bank').forEach(b => { b.innerHTML = ''; });
            score = totalItems;
            setupDragAndDrop();
            updateStats();
        }

        function showSummary() {
            const summaryContent = document.getElementById('summaryContent');
            summaryContent.innerHTML = '';
            Object.keys(gameData).forEach(entity => {
                const div = document.createElement('div');
                div.className = 'summary-drug';
                const catHtml = categoryKeys.map(cat => `
                    <div class="summary-category">
                        <div class="summary-category-title">${categoryLabels[cat]}:</div>
                        <div class="summary-category-content">${gameData[entity][cat]}</div>
                    </div>`).join('');
                div.innerHTML = `<div class="summary-drug-title">${entity}</div>${catHtml}`;
                summaryContent.appendChild(div);
            });
            document.getElementById('summaryModal').classList.add('active');
        }

        function closeSummary() { document.getElementById('summaryModal').classList.remove('active'); }

        function resetGame() {
            if (!confirm('Reset the game?')) return;
            score = 0; initGame();
        }

        window.onload = initGame;
        document.getElementById('summaryModal').addEventListener('click', function(e) {
            if (e.target === this) closeSummary();
        });
    </script>
</body>
</html>
