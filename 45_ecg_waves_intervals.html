<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECG Waves &mdash; P, QRS, T Wave Anatomy &amp; Pathology</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #1a0008 0%, #330015 50%, #4c001f 100%); color: #e4e4e4; padding: 20px; min-height: 100vh; }
        .container { max-width: 1600px; margin: 0 auto; }
        h1 { text-align: center; color: #fb7185; margin-bottom: 10px; font-size: 2.2em; text-shadow: 0 0 20px rgba(251,113,133,0.5); }
        .subtitle { text-align: center; color: #a0a0a0; margin-bottom: 25px; font-size: 1.1em; }
        .stats-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px; }
        .stats { display: flex; gap: 25px; flex-wrap: wrap; }
        .stat-item { background: rgba(251,113,133,0.1); padding: 12px 20px; border-radius: 8px; border: 1px solid rgba(251,113,133,0.3); }
        .stat-label { color: #fb7185; font-weight: bold; margin-right: 8px; }
        .controls { display: flex; gap: 12px; flex-wrap: wrap; }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.95em; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .btn-primary { background: linear-gradient(135deg, #9f1239 0%, #881337 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); }
        .btn-secondary { background: linear-gradient(135deg, #be123c 0%, #9f1239 100%); color: white; }
        .btn-secondary:hover { transform: translateY(-2px); }
        .btn-success { background: linear-gradient(135deg, #fb7185 0%, #f43f5e 100%); color: #1a0008; }
        .btn-success:hover { transform: translateY(-2px); }
        .btn-danger { background: linear-gradient(135deg, #ef4444 0%, #b91c1c 100%); color: white; }
        .btn-danger:hover { transform: translateY(-2px); }
        .main-content { display: grid; grid-template-columns: 350px 1fr; gap: 25px; align-items: start; }
        .word-bank-container { position: sticky; top: 20px; background: rgba(26,0,8,0.95); border-radius: 12px; padding: 20px; border: 2px solid rgba(251,113,133,0.3); box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
        .word-bank-title { color: #fb7185; font-size: 1.3em; margin-bottom: 15px; text-align: center; font-weight: bold; }
        .tabs { display: flex; gap: 5px; margin-bottom: 15px; border-bottom: 2px solid rgba(251,113,133,0.3); }
        .tab { flex: 1; padding: 10px; background: rgba(255,255,255,0.05); border: none; color: #a0a0a0; cursor: pointer; transition: all 0.3s ease; font-size: 0.85em; font-weight: 600; border-radius: 8px 8px 0 0; }
        .tab.active { background: linear-gradient(135deg, #9f1239 0%, #881337 100%); color: white; }
        .tab:hover:not(.active) { background: rgba(255,255,255,0.1); color: #e4e4e4; }
        .word-bank { min-height: 400px; max-height: 70vh; overflow-y: auto; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px; display: none; }
        .word-bank.active { display: block; }
        .word-bank::-webkit-scrollbar { width: 8px; }
        .word-bank::-webkit-scrollbar-thumb { background: rgba(251,113,133,0.5); border-radius: 4px; }
        .draggable-item { background: linear-gradient(135deg, #4c001f 0%, #330015 100%); padding: 12px 15px; margin-bottom: 10px; border-radius: 8px; cursor: move; border: 2px solid rgba(251,113,133,0.4); transition: all 0.3s ease; font-size: 0.95em; line-height: 1.4; }
        .draggable-item:hover { background: linear-gradient(135deg, #66002a 0%, #4c001f 100%); border-color: #fb7185; transform: translateX(5px); box-shadow: 0 4px 15px rgba(251,113,133,0.3); }
        .draggable-item.dragging { opacity: 0.5; transform: rotate(2deg); }
        .cards-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(480px, 1fr)); gap: 20px; }
        .drug-card { background: rgba(38,0,15,0.95); border-radius: 12px; padding: 20px; border: 2px solid rgba(251,113,133,0.3); box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
        .drug-card-title { background: linear-gradient(135deg, #9f1239 0%, #881337 100%); color: white; padding: 12px; border-radius: 8px; font-size: 1.2em; font-weight: bold; margin-bottom: 15px; text-align: center; }
        .drop-zones { display: grid; gap: 12px; }
        .drop-row { display: grid; grid-template-columns: 140px 1fr; gap: 10px; align-items: start; }
        .drop-label { background: rgba(251,113,133,0.1); padding: 10px; border-radius: 6px; font-weight: 600; color: #fb7185; font-size: 0.9em; display: flex; align-items: center; border: 1px solid rgba(251,113,133,0.3); }
        .drop-zone { min-height: 60px; background: rgba(0,0,0,0.3); border: 2px dashed rgba(251,113,133,0.3); border-radius: 8px; padding: 10px; transition: all 0.3s ease; display: flex; flex-direction: column; gap: 8px; }
        .drop-zone.drag-over { background: rgba(251,113,133,0.2); border-color: #fb7185; border-style: solid; box-shadow: 0 0 20px rgba(251,113,133,0.3); }
        .dropped-item { background: linear-gradient(135deg, #4c001f 0%, #330015 100%); padding: 10px 12px; border-radius: 6px; cursor: move; border: 2px solid rgba(251,113,133,0.4); transition: all 0.3s ease; font-size: 0.9em; line-height: 1.4; }
        .dropped-item.correct { background: linear-gradient(135deg, #0f9b0f 0%, #0a7c0a 100%); border-color: #00ff00; animation: correctPulse 0.5s ease; }
        .dropped-item.incorrect { background: linear-gradient(135deg, #c41e3a 0%, #9a1829 100%); border-color: #ff4444; animation: incorrectShake 0.5s ease; }
        @keyframes correctPulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05);box-shadow:0 0 20px rgba(0,255,0,0.5)} }
        @keyframes incorrectShake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
        .summary-modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        .summary-modal.active { display: flex; }
        .summary-content { background: linear-gradient(135deg, #1a0008 0%, #330015 100%); border-radius: 12px; padding: 30px; max-width: 900px; max-height: 90vh; overflow-y: auto; border: 2px solid rgba(251,113,133,0.5); box-shadow: 0 10px 50px rgba(0,0,0,0.8); }
        .summary-content::-webkit-scrollbar { width: 10px; }
        .summary-content::-webkit-scrollbar-thumb { background: rgba(251,113,133,0.5); border-radius: 5px; }
        .summary-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid rgba(251,113,133,0.3); }
        .summary-title { color: #fb7185; font-size: 1.8em; font-weight: bold; }
        .close-btn { background: rgba(255,68,68,0.2); border: 2px solid #ff4444; color: #ff4444; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; }
        .close-btn:hover { background: #ff4444; color: white; }
        .summary-drug { margin-bottom: 25px; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 8px; border-left: 4px solid #fb7185; }
        .summary-drug-title { color: #fb7185; font-size: 1.3em; margin-bottom: 15px; font-weight: bold; }
        .summary-category { margin-bottom: 12px; }
        .summary-category-title { color: #fda4af; font-weight: 600; margin-bottom: 5px; font-size: 1.05em; }
        .summary-category-content { color: #e4e4e4; padding-left: 15px; line-height: 1.6; }
        @media (max-width: 1200px) { .main-content { grid-template-columns: 1fr; } .word-bank-container { position: relative; } .cards-container { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { h1 { font-size: 1.6em; } .stats-controls { flex-direction: column; } .drop-row { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
<a href="index.html" style="position:fixed;top:12px;left:12px;z-index:9999;background:rgba(0,0,0,0.55);color:#94a3b8;border:1px solid rgba(255,255,255,0.13);border-radius:20px;padding:5px 13px;font-size:.72rem;text-decoration:none;font-family:'Segoe UI',sans-serif;backdrop-filter:blur(8px);transition:.15s;letter-spacing:.3px;" onmouseover="this.style.color='#f1f5f9';this.style.borderColor='rgba(255,255,255,0.3)'" onmouseout="this.style.color='#94a3b8';this.style.borderColor='rgba(255,255,255,0.13)'">&#8592; Index</a>
<a href="44_ecg_axis_placement.html" style="position:fixed;top:12px;z-index:9999;background:rgba(0,0,0,0.55);color:#94a3b8;border:1px solid rgba(255,255,255,0.13);border-radius:20px;padding:5px 11px;font-size:.78rem;text-decoration:none;font-family:'Segoe UI',sans-serif;backdrop-filter:blur(8px);transition:.15s;right:58px;" onmouseover="this.style.color='#f1f5f9';this.style.borderColor='rgba(255,255,255,0.3)'" onmouseout="this.style.color='#94a3b8';this.style.borderColor='rgba(255,255,255,0.13)'">&#8592;</a>
<a href="46_ecg_segments.html" style="position:fixed;top:12px;z-index:9999;background:rgba(0,0,0,0.55);color:#94a3b8;border:1px solid rgba(255,255,255,0.13);border-radius:20px;padding:5px 11px;font-size:.78rem;text-decoration:none;font-family:'Segoe UI',sans-serif;backdrop-filter:blur(8px);transition:.15s;right:12px;" onmouseover="this.style.color='#f1f5f9';this.style.borderColor='rgba(255,255,255,0.3)'" onmouseout="this.style.color='#94a3b8';this.style.borderColor='rgba(255,255,255,0.13)'">&#8594;</a>

    <div class="container">
        <h1>&#128201; ECG Waves &mdash; P, QRS, T Wave Anatomy &amp; Pathology</h1>
        <p class="subtitle">Match each wave with its physiologic representation, lead II appearance, normal value, and pathological significance</p>
        <div class="stats-controls">
            <div class="stats">
                <div class="stat-item"><span class="stat-label">Score:</span><span id="score">0</span>/<span id="total">0</span></div>
                <div class="stat-item"><span class="stat-label">Remaining:</span><span id="remaining">0</span></div>
            </div>
            <div class="controls">
                <button class="btn btn-primary" onclick="showSummary()">&#128203; Show Summary</button>
                <button class="btn btn-secondary" onclick="showHint()">&#128161; Hint</button>
                <button class="btn btn-success" onclick="showAllAnswers()">&#10003; Show All Answers</button>
                <button class="btn btn-danger" onclick="resetGame()">&#128260; Reset</button>
            </div>
        </div>
        <div class="main-content">
            <div class="word-bank-container">
                <div class="word-bank-title">&#128218; Word Bank</div>
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('physiology', this)">Physiology</button>
                    <button class="tab" onclick="switchTab('leadIIAppearance', this)">Lead II</button>
                    <button class="tab" onclick="switchTab('normalValue', this)">Normal Value</button>
                    <button class="tab" onclick="switchTab('pathology', this)">Pathology</button>
                </div>
                <div id="physiology-bank" class="word-bank active"></div>
                <div id="leadIIAppearance-bank" class="word-bank"></div>
                <div id="normalValue-bank" class="word-bank"></div>
                <div id="pathology-bank" class="word-bank"></div>
            </div>
            <div class="cards-container" id="cards-container"></div>
        </div>
    </div>
    <div class="summary-modal" id="summaryModal">
        <div class="summary-content">
            <div class="summary-header">
                <div class="summary-title">&#128214; Complete Summary</div>
                <button class="close-btn" onclick="closeSummary()">Close</button>
            </div>
            <div id="summaryContent"></div>
        </div>
    </div>
    <script>
        const categoryKeys = ['physiology', 'leadIIAppearance', 'normalValue', 'pathology'];
        const categoryLabels = { physiology: 'Physiologic Representation', leadIIAppearance: 'Appearance in Lead II', normalValue: 'Normal Duration / Amplitude', pathology: 'Pathological Change & Cause' };
        const gameData = {
            "P Wave": {
                physiology: "Atrial depolarization; originates from SA node in upper right atrium at SVC-RA junction; spreads inferior and leftward",
                leadIIAppearance: "Upright (positive) deflection; SA node depolarization travels inferior and leftward toward lead II electrode",
                normalValue: "Duration <120 ms (<3 small boxes); amplitude <2.5 mm in limb leads and <1.5 mm in precordial leads",
                pathology: "Absent + irregular rhythm = AFib; tall peaked P >2.5 mm = P pulmonale (RVH); bifid P = P mitrale (LAE)"
            },
            "Q Wave": {
                physiology: "Initial interventricular septal depolarization; septum activated rightward and inferiorly by left bundle branch first",
                leadIIAppearance: "Small downward (negative) deflection; septum depolarizes rightward AWAY from lead II electrode",
                normalValue: "Small septal Q waves normal if <40 ms duration and <25% of R wave amplitude in the same lead",
                pathology: "Pathologic Q waves (>40 ms or >25% of R): indicates myocardial infarction scar; appears hours after MI onset"
            },
            "R Wave": {
                physiology: "Main ventricular mass depolarization; LV free wall activated leftward and inferior â€” the dominant ventricular vector",
                leadIIAppearance: "Dominant upward (positive) deflection; largest wave; LV mass travels toward lead II electrode inferiorly",
                normalValue: "Tall in II, III, aVF; R wave progression V1\u2192V6 (small to large); R:S ratio >1 by V5-V6 indicates normal transition",
                pathology: "Enlarged R wave = ventricular hypertrophy (Sokolov-Lyon: S in V1 + R in V5 >35 mm); poor R progression = anterior MI"
            },
            "S Wave": {
                physiology: "Terminal ventricular depolarization of posterior LV basal region and RV; depolarizes rightward away from lead II",
                leadIIAppearance: "Small downward (negative) deflection following R wave; posterior forces move rightward AWAY from lead II",
                normalValue: "Small and variable in II; S wave prominent in V1-V2; overall S wave small compared to R in lateral leads",
                pathology: "Deep S in I, aVL with tall R in V1 = right axis deviation; can indicate RVH or right bundle branch block"
            },
            "T Wave": {
                physiology: "Ventricular repolarization; repolarization moves epicardium to endocardium, traveling AWAY from lead II electrode",
                leadIIAppearance: "Upright (positive) despite repolarization; asymmetric shape (gradual upslope, rapid downslope); follows QRS",
                normalValue: "Upright in most leads; should be \u22651/8 and \u22662/3 of R wave height; smooth asymmetric contour is normal",
                pathology: "Inverted T = ischemia/cardiomyopathy/myocarditis; peaked T = hyperkalemia (classic); flat T = hypokalemia, LVH strain"
            },
            "U Wave": {
                physiology: "Not consistently present; represents repolarization of Purkinje fibers or mid-myocardial M cells in some models",
                leadIIAppearance: "Small positive deflection after T wave if present; best seen in V2-V3; same polarity as T wave normally",
                normalValue: "Usually absent or very small (<25% of T wave amplitude); not consistently present on normal ECGs",
                pathology: "Prominent U waves = hypokalemia (classic association), bradycardia; inverted U = LVH, ischemia, hypertension"
            }
        };
        let score = 0, totalItems = 0, draggedElement = null, allItems = {};
        function initGame() {
            const cc = document.getElementById('cards-container'); cc.innerHTML = ''; allItems = {};
            categoryKeys.forEach(cat => { allItems[cat] = []; });
            Object.keys(gameData).forEach(entity => { categoryKeys.forEach(cat => { allItems[cat].push({ text: gameData[entity][cat], entity, category: cat }); }); });
            categoryKeys.forEach(cat => { allItems[cat] = shuffleArray(allItems[cat]); });
            totalItems = Object.keys(gameData).length * categoryKeys.length; score = 0;
            Object.keys(gameData).forEach(entity => {
                const card = document.createElement('div'); card.className = 'drug-card';
                const zonesHtml = categoryKeys.map(cat => `<div class="drop-row"><div class="drop-label">${categoryLabels[cat]}</div><div class="drop-zone" data-entity="${entity}" data-category="${cat}"></div></div>`).join('');
                card.innerHTML = `<div class="drug-card-title">${entity}</div><div class="drop-zones">${zonesHtml}</div>`;
                cc.appendChild(card);
            });
            populateWordBanks(); setupDragAndDrop(); updateStats();
        }
        function shuffleArray(arr) { const a = [...arr]; for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }
        function populateWordBanks() {
            categoryKeys.forEach(cat => {
                const bank = document.getElementById(cat + '-bank'); bank.innerHTML = '';
                allItems[cat].forEach(item => {
                    const div = document.createElement('div'); div.className = 'draggable-item'; div.draggable = true;
                    div.textContent = item.text; div.dataset.entity = item.entity; div.dataset.category = item.category; bank.appendChild(div);
                });
            });
        }
        function switchTab(cat, btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.word-bank').forEach(b => b.classList.remove('active'));
            btn.classList.add('active'); document.getElementById(cat + '-bank').classList.add('active');
        }
        function setupDragAndDrop() {
            document.addEventListener('dragstart', e => { if (e.target.classList.contains('draggable-item') || e.target.classList.contains('dropped-item')) { draggedElement = e.target; e.target.classList.add('dragging'); e.dataTransfer.effectAllowed = 'move'; } });
            document.addEventListener('dragend', e => { if (e.target.classList.contains('dragging')) e.target.classList.remove('dragging'); });
            document.addEventListener('dragover', e => { const zone = e.target.closest('.drop-zone'); if (zone) { e.preventDefault(); zone.classList.add('drag-over'); } });
            document.addEventListener('dragleave', e => { const zone = e.target.closest('.drop-zone'); if (zone) zone.classList.remove('drag-over'); });
            document.addEventListener('drop', e => { const zone = e.target.closest('.drop-zone'); if (zone && draggedElement) { e.preventDefault(); zone.classList.remove('drag-over'); handleDrop(zone, draggedElement); } });
            let touchItem = null, touchClone = null;
            document.addEventListener('touchstart', e => { const item = e.target.closest('.draggable-item, .dropped-item'); if (!item) return; touchItem = item; touchClone = item.cloneNode(true); touchClone.style.cssText = 'position:fixed;opacity:0.8;pointer-events:none;z-index:9999;width:' + item.offsetWidth + 'px;'; document.body.appendChild(touchClone); }, { passive: true });
            document.addEventListener('touchmove', e => { if (!touchClone) return; const t = e.touches[0]; touchClone.style.left = (t.clientX - touchClone.offsetWidth / 2) + 'px'; touchClone.style.top = (t.clientY - 30) + 'px'; }, { passive: true });
            document.addEventListener('touchend', e => { if (!touchItem || !touchClone) return; const t = e.changedTouches[0]; const el = document.elementFromPoint(t.clientX, t.clientY); const zone = el ? el.closest('.drop-zone') : null; if (zone) handleDrop(zone, touchItem); touchClone.remove(); touchItem = null; touchClone = null; });
        }
        function handleDrop(zone, item) {
            const targetEntity = zone.dataset.entity, targetCategory = zone.dataset.category;
            const itemEntity = item.dataset.entity, itemCategory = item.dataset.category;
            if (itemCategory !== targetCategory) return;
            if (item.parentElement === zone) return;
            if (zone.children.length > 0) {
                const existing = zone.children[0]; const bank = document.getElementById(existing.dataset.category + '-bank');
                const r = document.createElement('div'); r.className = 'draggable-item'; r.draggable = true;
                r.textContent = existing.textContent; r.dataset.entity = existing.dataset.entity; r.dataset.category = existing.dataset.category;
                if (existing.classList.contains('correct')) { score--; updateStats(); }
                existing.remove(); bank.appendChild(r);
            }
            const dropped = document.createElement('div'); dropped.className = 'dropped-item'; dropped.draggable = true;
            dropped.textContent = item.textContent; dropped.dataset.entity = itemEntity; dropped.dataset.category = itemCategory;
            const isCorrect = itemEntity === targetEntity;
            dropped.classList.add(isCorrect ? 'correct' : 'incorrect');
            if (isCorrect) { score++; updateStats(); }
            zone.appendChild(dropped);
            if (item.classList.contains('draggable-item') || item.classList.contains('dropped-item')) item.remove();
            if (!isCorrect) {
                setTimeout(() => {
                    if (dropped.parentElement === zone) {
                        const bank = document.getElementById(itemCategory + '-bank');
                        const r = document.createElement('div'); r.className = 'draggable-item'; r.draggable = true;
                        r.textContent = dropped.textContent; r.dataset.entity = itemEntity; r.dataset.category = itemCategory;
                        dropped.remove(); bank.appendChild(r);
                    }
                }, 1000);
            }
            checkCompletion();
        }
        function updateStats() {
            document.getElementById('score').textContent = score; document.getElementById('total').textContent = totalItems;
            document.getElementById('remaining').textContent = totalItems - document.querySelectorAll('.drop-zone .dropped-item').length;
        }
        function checkCompletion() { if (document.querySelectorAll('.drop-zone .dropped-item').length === totalItems && score === totalItems) setTimeout(() => alert('Congratulations! All answers correct!'), 300); }
        function showHint() {
            const emptyZones = document.querySelectorAll('.drop-zone:empty');
            if (emptyZones.length === 0) { alert('All zones are filled!'); return; }
            const zone = emptyZones[Math.floor(Math.random() * emptyZones.length)];
            alert(`Hint for "${zone.dataset.entity}" - ${categoryLabels[zone.dataset.category]}:\n\n${gameData[zone.dataset.entity][zone.dataset.category]}`);
        }
        function showAllAnswers() {
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.innerHTML = '';
                const div = document.createElement('div'); div.className = 'dropped-item correct'; div.draggable = false;
                div.textContent = gameData[zone.dataset.entity][zone.dataset.category];
                div.dataset.entity = zone.dataset.entity; div.dataset.category = zone.dataset.category; zone.appendChild(div);
            });
            categoryKeys.forEach(cat => { document.getElementById(cat + '-bank').innerHTML = ''; });
            score = totalItems; updateStats();
        }
        function resetGame() { initGame(); }
        function showSummary() {
            document.getElementById('summaryContent').innerHTML = Object.keys(gameData).map(entity => `
                <div class="summary-drug"><div class="summary-drug-title">${entity}</div>
                ${categoryKeys.map(cat => `<div class="summary-category"><div class="summary-category-title">${categoryLabels[cat]}</div><div class="summary-category-content">${gameData[entity][cat]}</div></div>`).join('')}</div>`).join('');
            document.getElementById('summaryModal').classList.add('active');
        }
        function closeSummary() { document.getElementById('summaryModal').classList.remove('active'); }
        initGame();
    </script>
</body>
</html>
